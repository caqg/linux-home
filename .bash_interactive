# -*- Shell-Script -*-

case $(whoami) in
root)
    export PS1='# ' ;;
*)
    export PS1='$ ' ;;
esac

# export PS2='> '
# export PS3='? '
# export PS4='+ '

[ "$TERM" = "screen" ] && set -o vi
set -o ignoreeof
shopt -s cdspell
shopt -s globstar

function +    { pushd "$@"; }
function -    { popd "$@"; }
function =    { dirs -v "$@"; }

function 2top { cd $(git rev-parse --show-toplevel); }
function colorize-ls   { export LSFLAGS=--color=auto; eval $(dircolors ~/.dircolors); }
function uncolorize-ls { unset LSFLAGS; unset LS_COLORS; }

function dir  { LC_ALL=C /bin/dir ${LSFLAGS} -F "$@"; }
# function ef   { ~/cmd/e -nc "$@"; }
function gitl { git l ${1:+-n} ${1:--n 5}; }
function gits { git s; }
function h    { history "$@"; }
function hf   { if [ $# -gt 0 ]; then history | grep -e "$*" -; else history; fi; }
function j    { jobs "$@"; }
function k    { kill -9 "$@"; }
function l    { LC_ALL=C /bin/ls  ${LSFLAGS} -Alh --time-style=iso --group-directories-first "$@"; }
function lt   { LC_ALL=C /bin/ls  ${LSFLAGS} -Altrh --time-style=iso "$@"; }
# function o    { { [ $# -eq 0 ] && echo "." ; echo "$@"; } | /usr/bin/xargs -n1 /usr/bin/xdg-open; }
function v    { gvim -MR "$@"; }
function v-   { gvim -MR --not-a-term -; }
function vdir { LC_ALL=C /bin/vdir ${LSFLAGS} "$@"; }

case "${TERM}" in
xterm*|rxvt*)
    function updatePS1WithGitBranch {
	left='\[\e]0;\u@\h: \w'
	middle=$(git branch 2>/dev/null | sed -e '/^ /d' -e 's/^..\(.*\)/ git:\1/')
	right='\a\]\$ '
	PS1="$left$middle$right"
    }

    # case "$TERM" in
    # xterm*)	export TERM=xterm;;
    # xrvt*)	export TERM=xrvt;;
    # esac

    PROMPT_COMMAND=updatePS1WithGitBranch
    colorize-ls
    ;;
esac

# Use bash-completion, if available
[ -f /usr/share/bash-completion/bash_completion ] && \
    . /usr/share/bash-completion/bash_completion

##end .bash_interactive
