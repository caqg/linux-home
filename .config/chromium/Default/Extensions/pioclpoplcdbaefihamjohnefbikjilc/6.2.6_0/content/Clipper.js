function Clipper(){function k(b){for(var c=b.querySelectorAll("a.clearly_highlight_delete_element"),a=0;a<c.length;a++)c.item(a).parentNode.removeChild(c.item(a));b=b.querySelectorAll("em.clearly_highlight_element");for(a=0;a<b.length;a++)b.item(a).outerHTML="<highlight>"+b.item(a).innerHTML+"</highlight>"}function h(b,c,a,g,d,e){function f(a,b){b?e(b):r(a)}l=b;m=c;n=a;r=g;if(d)p.serialize(l,m,n,f,null,d);else{b=function(a){p.serialize(l,m,n,f,a)};try{serializeFrames(b)}catch(h){e(h)}}}var p=new HtmlSerializer,
l,m,n,r;this.clipArticle=function(b,c,a){function g(d){q+=d;f<e.length?h(e[f++],null,b,g,null,a):c(q)}var d,e=pageInfo.getAdditionalPages(),f=0,q="";try{if(d=contentPreview.getArticleElement()){k(d);h(d,null,b,g,null,a);return}}catch(l){log.warn("Couldn't get preview from contentPreview. Trying pageInfo.")}try{pageInfo.getDefaultArticle(function(c){d=c;k(d);h(d,null,b,g,null,a)});return}catch(m){log.warn("Couldn't get article from pageInfo. Trying default.")}d=document.body;k(d);h(d,null,b,g,null,
a)};this.clipEmail=function(b,c){var a=contentPreview.getEmailElement();k(a);h(a,null,!0,b,null,c)};this.clipImage=function(b,c){var a=document.querySelector("img[src='"+b+"'], img[src$='"+b.replace(document.body.baseURI,"")+"']"),a=p.convertImgSrcToBase64IfPossible(a,b,!0);a===b&&(a=GlobalUtils.escapeXML(a));c('<img src="'+a+'"></img>')};this.clipFullPage=function(b,c,a){k(document.body);h(document.body,null,b,c,null,a)};this.clipPdf=function(b){b('<embed src="'+GlobalUtils.escapeXML(pageInfo.getPdfUrl())+
'" type="application/pdf"></embed>')};this.clipSelection=function(b,c,a,g){if(c&&document.querySelector("embed[type='application/pdf']"))a(c);else{var d,e;try{if(d=contentPreview.ensureSelectionIsShown())if(e=d.getRangeAt(0))if(e.commonAncestorContainer.nodeType==Node.TEXT_NODE){var f=e.commonAncestorContainer.textContent.substring(e.startOffset,e.endOffset),f=f.replace(/&/g,"&amp;"),f=f.replace(/</g,"&lt;"),f=f.replace(/>/g,"&gt;");a(f)}else k(e.commonAncestorContainer),h(e.commonAncestorContainer,
e,b,a,null,g)}catch(l){a("")}}};this.clipUrl=function(b){var c=contentPreview.getUrlElement(function(a){b(a)});c&&b(c)};this.clipClearly=function(b,c){for(var a=contentPreview.getClearlyReformat(),g=a.$iframePages[0].getElementsByTagName("span"),d=0;d<g.length;d++)g.item(d).parentNode.removeChild(g.item(d));k(a.$iframePages[0]);h(a.$iframePages[0],null,!1,b,a.iframe.contentWindow,c)};Object.preventExtensions(this)}Object.preventExtensions(Clipper);
